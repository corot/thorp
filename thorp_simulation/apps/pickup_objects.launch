<!--
Pickup reachable objects app:
  - Thorp Gazebo simulation
  - Executive SMACH and visualization

Pick all objects at hand in the table in front.
 -->

<launch>
  <arg name="app_name" value="pickup_objects"/>
  <arg name="viz_smach" default="false"/>

  <!--  ***** Simulated mobile manipulator Thorp ******  -->
  <include file="$(find thorp_simulation)/launch/thorp_gazebo.launch">
    <arg name="world_name"     default="playground"/>
    <arg name="initial_pose_x" default="0.0"/>
    <arg name="initial_pose_y" default="0.0"/>
    <arg name="initial_pose_a" default="0.0"/>
    <arg name="localization"   value="gazebo"/>
  </include>

  <!--  ********* Perception and manipulation *********  -->
  <include file="$(find thorp_perception)/launch/perception.launch">
    <arg name="pipeline" value="RAIL"/>
  </include>

  <include file="$(find thorp_manipulation)/launch/manipulation.launch">
    <arg name="simulation" value="true"/>
    <arg name="debug" value="false"/>
  </include>

  <!--  ****** Executive smach and visualization ******  -->
  <node pkg="thorp_smach" type="$(arg app_name).py" name="$(arg app_name)_smach" output="screen" respawn="false">
    <param name="app_name" value="$(arg app_name)"/>
    <param name="viz_smach" value="$(arg viz_smach)"/>
  </node>

  <node if="$(arg viz_smach)"
       pkg="smach_viewer" type="smach_viewer.py" name="$(arg app_name)_smach_viewer" output="screen" respawn="true"/>

  <node name="rviz" pkg="rviz" type="rviz" args="-d $(find thorp_bringup)/rviz/manipulation.rviz" output="screen" respawn="true"/>
</launch>
