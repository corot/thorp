<?xml version="1.0" encoding="UTF-8"?>
<root BTCPP_format="3">
  <BehaviorTree ID="explore_house">
    <Sequence>
      <GetRobotPose timeout="10.0"
                    error=""
                    robot_pose="{robot_pose}"/>
      <SegmentRooms action_name="exploration/room_segmentation"
                    goal=""
                    server_timeout="5.000000"
                    map_image="{map_image}"
                    map_origin="{map_origin}"
                    map_resolution="{map_resolution}"
                    robot_radius="{robot_radius}"
                    room_information_in_meter="{room_information_in_meter}"
                    room_information_in_pixel="{room_information_in_pixel}"
                    segmented_map="{segmented_map}"/>
      <PlanRoomSequence action_name="exploration/room_sequence_planning"
                        goal=""
                        map_image="{map_image}"
                        map_origin="{map_origin}"
                        map_resolution="{map_resolution}"
                        robot_pose="{robot_pose}"
                        robot_radius="{robot_radius}"
                        room_information_in_pixel="{room_information_in_pixel}"
                        server_timeout="5.000000"
                        room_sequence=""/>
      <SetBlackboard value="3"
                     output_key="room_number"/>
      <PlanRoomExploration action_name="exploration/room_exploration"
                           goal=""
                           map_image="{map_image}"
                           map_origin="{map_origin}"
                           map_resolution="{map_resolution}"
                           robot_pose="{robot_pose}"
                           robot_radius="{robot_radius}"
                           room_information_in_meter="{room_information_in_meter}"
                           room_number="{room_number}"
                           segmented_map="{segmented_map}"
                           server_timeout="5.000000"
                           coverage_path=""
                           start_pose=""/>
    </Sequence>
  </BehaviorTree>

  <!-- Description of Node Models (used by Groot) -->
  <TreeNodesModel>
    <Action ID="GetRobotPose">
      <input_port name="timeout"
                  type="double"/>
      <output_port name="error"
                   type="unsigned int"/>
      <output_port name="robot_pose"
                   type="geometry_msgs::PoseStamped_&lt;std::allocator&lt;void&gt; &gt;"/>
    </Action>
    <Action ID="PlanRoomExploration">
      <input_port name="action_name"
                  type="std::string">name of the ROS action client</input_port>
      <input_port name="goal"
                  type="ipa_building_msgs::RoomExplorationGoal_&lt;std::allocator&lt;void&gt; &gt;">goal to send to the action server</input_port>
      <input_port name="map_image"
                  type="sensor_msgs::Image_&lt;std::allocator&lt;void&gt; &gt;"/>
      <input_port name="map_origin"
                  type="geometry_msgs::Pose_&lt;std::allocator&lt;void&gt; &gt;"/>
      <input_port name="map_resolution"
                  type="float"/>
      <input_port name="robot_pose"
                  type="geometry_msgs::PoseStamped_&lt;std::allocator&lt;void&gt; &gt;"/>
      <input_port name="robot_radius"
                  type="float"/>
      <input_port name="room_information_in_meter"
                  type="std::vector&lt;ipa_building_msgs::RoomInformation_&lt;std::allocator&lt;void&gt; &gt;, std::allocator&lt;ipa_building_msgs::RoomInformation_&lt;std::allocator&lt;void&gt; &gt; &gt; &gt;"/>
      <input_port name="room_number"
                  type="unsigned int"/>
      <input_port name="segmented_map"
                  type="sensor_msgs::Image_&lt;std::allocator&lt;void&gt; &gt;"/>
      <input_port name="server_timeout"
                  default="5.000000"
                  type="double">timeout to connect to server (seconds)</input_port>
      <output_port name="coverage_path"
                   type="std::vector&lt;geometry_msgs::PoseStamped_&lt;std::allocator&lt;void&gt; &gt;, std::allocator&lt;geometry_msgs::PoseStamped_&lt;std::allocator&lt;void&gt; &gt; &gt; &gt;"/>
      <output_port name="start_pose"
                   type="geometry_msgs::PoseStamped_&lt;std::allocator&lt;void&gt; &gt;"/>
    </Action>
    <Action ID="PlanRoomSequence">
      <input_port name="action_name"
                  type="std::string">name of the ROS action client</input_port>
      <input_port name="goal"
                  type="ipa_building_msgs::FindRoomSequenceWithCheckpointsGoal_&lt;std::allocator&lt;void&gt; &gt;">goal to send to the action server</input_port>
      <input_port name="map_image"
                  type="sensor_msgs::Image_&lt;std::allocator&lt;void&gt; &gt;"/>
      <input_port name="map_origin"
                  type="geometry_msgs::Pose_&lt;std::allocator&lt;void&gt; &gt;"/>
      <input_port name="map_resolution"
                  type="float"/>
      <input_port name="robot_pose"
                  type="geometry_msgs::PoseStamped_&lt;std::allocator&lt;void&gt; &gt;"/>
      <input_port name="robot_radius"
                  type="float"/>
      <input_port name="room_information_in_pixel"
                  type="std::vector&lt;ipa_building_msgs::RoomInformation_&lt;std::allocator&lt;void&gt; &gt;, std::allocator&lt;ipa_building_msgs::RoomInformation_&lt;std::allocator&lt;void&gt; &gt; &gt; &gt;"/>
      <input_port name="server_timeout"
                  default="5.000000"
                  type="double">timeout to connect to server (seconds)</input_port>
      <output_port name="room_sequence"
                   type="std::vector&lt;unsigned int, std::allocator&lt;unsigned int&gt; &gt;"/>
    </Action>
    <Action ID="SegmentRooms">
      <input_port name="action_name"
                  type="std::string">name of the ROS action client</input_port>
      <input_port name="goal"
                  type="ipa_building_msgs::MapSegmentationGoal_&lt;std::allocator&lt;void&gt; &gt;">goal to send to the action server</input_port>
      <input_port name="server_timeout"
                  default="5.000000"
                  type="double">timeout to connect to server (seconds)</input_port>
      <output_port name="map_image"
                   type="sensor_msgs::Image_&lt;std::allocator&lt;void&gt; &gt;"/>
      <output_port name="map_origin"
                   type="geometry_msgs::Pose_&lt;std::allocator&lt;void&gt; &gt;"/>
      <output_port name="map_resolution"
                   type="float"/>
      <output_port name="robot_radius"
                   type="float"/>
      <output_port name="room_information_in_meter"
                   type="std::vector&lt;ipa_building_msgs::RoomInformation_&lt;std::allocator&lt;void&gt; &gt;, std::allocator&lt;ipa_building_msgs::RoomInformation_&lt;std::allocator&lt;void&gt; &gt; &gt; &gt;"/>
      <output_port name="room_information_in_pixel"
                   type="std::vector&lt;ipa_building_msgs::RoomInformation_&lt;std::allocator&lt;void&gt; &gt;, std::allocator&lt;ipa_building_msgs::RoomInformation_&lt;std::allocator&lt;void&gt; &gt; &gt; &gt;"/>
      <output_port name="segmented_map"
                   type="sensor_msgs::Image_&lt;std::allocator&lt;void&gt; &gt;"/>
    </Action>
  </TreeNodesModel>

</root>
